## 符号约定
### 旋转矩阵
$R_1(\varphi)=\left\[\begin{matrix}1 & 0 & 0\cr0 & \cos\varphi & \sin\varphi\cr0 & -\sin\varphi & \cos\varphi\end{matrix}\right\]$（表示标架绕 $x$ 轴旋转 $\varphi$，或地球绕 $x$ 轴旋转 $-\varphi$）

$R_2(\varphi)=\left\[\begin{matrix}\cos\varphi & 0 & -\sin\varphi\cr0 & 1 & 0\cr\sin\varphi & 0 & \cos\varphi\end{matrix}\right\]$（表示标架绕 $y$ 轴旋转 $\varphi$，或地球绕 $y$ 轴旋转 $-\varphi$）

$R_3(\varphi)=\left\[\begin{matrix}\cos\varphi & \sin\varphi & 0\cr-\sin\varphi & \cos\varphi & 0\cr0 & 0 & 1\end{matrix}\right\]$（表示标架绕 $z$ 轴旋转 $\varphi$，或地球绕 $z$ 轴旋转 $-\varphi$）

### 单位
单位约定与国际单位制（法 Système international d'unités, SI、英 International System of Units）规范文本一致，以下提及部分。

$\text{s}$ 表示秒（英 second、法 seconde），定义为 $1\kern{3 mu}\text{s}=\dfrac{9192631770}{\Delta\nu_\text{Cs}}$（其中 $\Delta\nu_\text{Cs}$ 是铯-133 原子不受扰动的基态超精细能级跃迁频率），是量纲时间（英 time、法 temps，符号为 $\text{T}$）对应的基本单位。

$\text{m}$ 表示米（英 metre、法 mètre），定义为 $1\kern{3 mu}\text{m}=\dfrac{c}{299792458}\kern{3 mu}\text{s}$（其中 $c$ 是真空光速），是量纲长度（英 length、法 longueur，符号为 $\text{L}$）对应的基本单位。

$\text{rad}$ 表示弧度（英 radian、法 radian），定义为 $\text{rad}=\kern{0 mu}^\text{m}\kern{-3 mu}/\kern{-3 mu}\_\text{m}$，用于度量平面角。

$\text{min}$ 表示分（英 minute、法 minute），定义为 $1\kern{3 mu}\text{min}=60\kern{3 mu}\text{s}$，用于度量时间。

$\text{h}$ 表示（小）时（英 hour、法 heure），定义为 $1\kern{3 mu}\text{h}=60\kern{3 mu}\text{min}=3600\kern{3 mu}\text{s}$，用于度量时间。

$\text{d}$ 表示天（日）（英 day、法 jour），定义为 $1\kern{3 mu}\text{d}=24\kern{3 mu}\text{h}=86400\kern{3 mu}\text{s}$，用于度量时间。

$^\circ$ 表示度（英 degree、法 degré），定义为 $1^\circ=\dfrac{\pi}{180}\kern{3 mu}\text{rad}$，用于度量平面角。

$'$ 表示（角）分（英 (arc)minute、法 (arc)minute），定义为 $1'=\dfrac{1}{60}^\circ=\dfrac{\pi}{10800}\kern{3 mu}\text{rad}$，用于度量平面角。

$''$ 或 $\text{as}$ 表示（角）秒（英 (arc)second、法 (arc)seconde），定义为 $1''=1\kern{3 mu}\text{as}=\dfrac{1}{60}'=\dfrac{\pi}{648000}\kern{3 mu}\text{rad}$，用于度量平面角。

$\mu\text{as}$ 表示微角秒（英 microarcsecond、法 microarcseconde），定义为 $1\kern{3 mu}\mu\text{as}=10^{-6}\kern{3 mu}\text{as}=\dfrac{\pi}{648000000000}\kern{3 mu}\text{rad}$，用于度量平面角。

### 日期
日期未作说明时总以（倒推）公历理解。

### 时刻标度
时刻标度未作说明时总以零时区理解。

## Julius 日数及其衍生
### Julius 日数
从零时区的倒推 Julius 历公元前 4713 年 1 月 1 日（即倒推公历公元前 4714 年 11 月 24 日）正午（12:00:00）起算的整天数称为 Julius 日数（英 Julian day number, JDN）。

「整天数」仍不够明确，需要给出确切的阐述：JDN 在且仅在每天的 12:00:00 改变，幅度为 1；时刻标度到 JDN 的函数不减且右连续；公元前 4714 年 11 月 24 日 12:00:00 的 JDN 为 0。

例如，当且仅当时刻位于区间 \[公元前 4714 年 11 月 24 日 12:00:00, 公元前 4714 年 11 月 25 日 12:00:00) 内时 JDN 为 0。

### Julius 日
令当前 JDN 对应的起始时刻为 0，下一 JDN 对应的起始时刻为 1 作关于时刻标度的一次函数，则该函数即给出 $\[0,1)$ 范围内的实数。将其加上 JDN，得到的实数便是 Julius 日（英 Julian date, JD）。

可以看出，JD 的整数部分是 JDN，而小数部分对应的是一天内的进度。当且仅当时刻为某天的 12:00:00 时 JD 为整数。

### 约化 Julius 日
JD 有两个问题：一个是起点过于久远，于是表示当今时刻数值就显得较大；另一个是整数对应的时刻是 12:00:00 而非 00:00:00，整数部分就与对应时刻下的日期部分并不一致。

前者可以减去大整数解决，后者可以减去 0.5 解决。因此将 JD 减去 2400000.5，得到约化 Julius 日（英 Modified Julian date, MJD）。

$\text{MJD}=\text{JD}-2400000.5$

最后强调，JD 这类表示法必须指明时间尺度才能解读意义。因为这类表示法是时刻标度到实数的双射，而时刻与其标度的具体关系取决于时间尺度——同一时刻依时间尺度不同其标度可能不同，同一时刻标度依时间尺度不同其时刻也可能不同。

## 因研究地球而生的参考系
### 天球参考系与地球参考系
天球参考系（英 Celestial reference system, CRS）是标架相对于宇宙遥远物质固定的准惯性参考系，地球参考系（英 Terrestrial reference system, TRS）是标架随地球一同旋转的参考系。

当然，这种概念约束不过限定在标架上面而已，对原点的情形则没有限制。

### 按原点分类
如果将常见的 CRS 与 TRS 按原点分类，则可以细分为三种：
- 质心天球参考系（英 Barycentric Celestial Reference System, BCRS）
- 地心天球参考系（英 Geocentric Celestial Reference System, GCRS）
- 地心地球参考系（英 Geocentric Terrestrial Reference System, GTRS）

质心地球参考系就不太有用的必要。

### 协议天球参考系与协议地球参考系
出于交流的需要，自然需要约定参考系的参数来共同应用。由此得到协议天球参考系（英 Conventional celestial reference system, CCRS）与协议地球参考系（英 Conventional terrestrial reference system, CTRS）。

就「协议」而言倒不见得世界通用，只有两方用也能叫协议。

### 国际天球参考系与国际地球参考系
国际地球自转和参考系服务（英 International Earth Rotation and Reference Systems Service, IERS）在 CRS 方面提出了国际天球参考系（英 International Celestial Reference System, ICRS）并被国际天文学联合会（英 International Astronomical Union, IAU、法 Union astronomique internationale, UAI）采用，在 TRS 方面提出了国际地球参考系（英 International Terrestrial Reference System, ITRS）。

于是，ICRS 与 ITRS 就各成为世界范围内通用的 CCRS 与 CTRS。

ICRS 与 ITRS 各是特殊的 BCRS 与 GTRS。

需要指出，如果没有特别说明，使用术语 BCRS 与 GCRS 时总是默认标架定向与 ICRS 一致——这是 IAU 2006 决议 B2 的规定。

### 在 ITRS 与 GCRS 间转换
这里介绍 ITRS 转至 GCRS 的过程，反过来的情形施逆变换即可。

本节中时刻参数定义为 $t=\dfrac{\text{TT}-\text{J2000.0}}{36525\kern{3 mu}\text{d}}$。

TT 是后续章节将提到的地球时，J2000.0 是地球时的 2000 年 1 月 1 日 12:00:00（以 JD 计便为 2451545.0）。

了解这样的约定，便可用 JD 更明确地表述时刻参数。

$t=\dfrac{\text{JD}\_\text{TT}-2451545.0}{36525}$

另外约定 $t_0$ 代表 J2000.0 时的 $t$，于是 $t_0=0$。

#### 极移
第一步，将 ITRS 变换至地球中间参考系（英 Terrestrial Intermediate Reference System, TIRS）。

TIRS 的 $z$ 轴指向天球中间极（英 Celestial Intermediate Pole, CIP），且 $x$ 轴指向地球中间零点（英 Terrestrial Intermediate Origin, TIO）。

$\text{\[TIRS\]}=W(t)\text{\[ITRS\]}$

$W(t)$ 的定义如下。

$W(t)=R_3(-s')R_2(x_p)R_1(y_p)$

$(x_p,y_p)$ 是 ITRS 中 CIP 的极点坐标。$x_p$ 与 $y_p$ 之正向依照 IERS 约定，分别指向 0° 与 90°W 经线。

这样 $z$ 轴的确指向了 CIP；但是就这一个条件并不足以确定参考系，因为 $x$ 轴与 $y$ 轴的方向未定。

因此还要用到 $x$ 轴指向 TIO 的条件。$s'$ 是 TIO 定位角，用来将 $x$ 轴旋转至 TIO。其定义如下。

$\displaystyle s'(t)=\dfrac{1}{2}\left.\int_{t_0}^{T}\left(x_p\dfrac{dy_p}{dt}-\dfrac{dx_p}{dt}y_p\right)dt\right\|\_{T=t}$

这样就把极移处理完了。

#### 自转
让 $z$ 轴指向 CIP 后，$z$ 轴也就成了地球的自转轴。

第二步，将 TIRS 变换至天球中间参考系（英 Celestial Intermediate Reference System, CIRS）。

CIRS 的 $z$ 轴指向 CIP，且 $x$ 轴指向天球中间零点（英 Celestial Intermediate Origin, CIO）。

$\text{\[CIRS\]}=R(t)\text{\[TIRS\]}$

$R(t)$ 的定义如下。

$R(t)=R_3(-\text{ERA})$

$\text{ERA}$ 是地球自转角，即 CIO 与 TIO 在 CIP 赤道上的夹角。注意到 R_3 的变量是 $\text{ERA}$ 的相反数——正如最开始的符号约定所言，$R_3(\varphi)$ 表示地球绕 $z$ 轴旋转 $-\varphi$。

自转也处理完了。

#### 岁差和章动
设 $(X,Y,Z)$ 是 GCRS 下原点到 CIP 的方向向量。

第三步，将 CIRS 变换至 GCRS。

$\text{\[GCRS\]}=Q(t)\text{\[CIRS\]}$

$Q(t)$ 的定义如下。

$Q(t)=R_3(-E)R_2(-d)R_3(E)R_3(s)$

$d$ 与 $E$ 可以依下式确定。

$(X,Y,Z)=(\sin d\cos E,\sin d\sin E,\cos d)$

虽说就是个球坐标的反解……

$s$ 是 CIO 定位角。其定义如下。

$\displaystyle s(t)=-\left.\int_{t_0}^{T}\dfrac{X(t)\dfrac{dY(t)}{dt}-Y(t)\dfrac{dX(t)}{dt}}{1+Z(t)}dt\right\|\_{T=t}-\left(\sigma_0N_0-\Sigma_0N_0\right)$

需要注意的是，天文学约定 $AB$ 表示以地心为顶点，两边各过 $A$ 与 $B$ 两点的角的大小，称其为 $A$ 与 $B$ 相对于地心的角距离。

其中 $\sigma_0$ 是 $t_0$ 时的 CIO，$\Sigma_0$ 是 GCRS 的 $x$ 零点，$N_0$ 是 $t_0$ 时 CIP 赤道在 GCRS 赤道上的升交点。

$t_0$ 依照 IERS 约定而同节首所言，代表 J2000.0 时的 $t$。IERS 还约定，该算法在其强制实施时点（2003 年 1 月 1 日）的计算结果应当同旧算法保持一致。由是，经过计算，积分常数 $s_0=-(\sigma_0N_0-\Sigma_0N_0)$ 确定为 $+94\kern{3 mu}\mu\text{as}$。

岁差和章动也处理了。

因此总变换可以写成下式。

$\text{\[GCRS\]}=Q(t)R(t)W(t)\text{\[ITRS\]}$

## 世界时
### 太阳日与恒星日
观察太阳照射的变化以感知并测量时间流逝是自古以来便为人——其实植物也会——采用的方法，典例有日晷。太阳经过地方经线的时刻称为太阳正午，此时太阳高度角达到极大值。相邻太阳正午之间的时间是一个太阳日。

直接观测得到的太阳日便是视太阳日。

不过中学物理和中学地理都有讲到 Kepler 三定律，也就能看出地球公转的速率并不均匀。而且地轴有着约 23 度 26 分的倾角（黄赤交角），于是日影的运行速率也不均匀。这样视太阳日便有不小的波动。

如果太阳相对地球在赤道面上匀速率转动就好了……那就假想一个这样的太阳，然后让公转周期和真正的太阳保持一致不就行了吗？这样假想出来的太阳称作平太阳，按平太阳计算的太阳日就是平太阳日。

从历史的角度来看，「天」最初指地球自转周期。地球自转是地球固有的性质，倒也不需要依赖太阳，找一个相对于宇宙遥远物质固定的方向看夹角变化就行了。通常选用春分点方向，并称春分点相邻两次经过地方经线之间的时间为一个恒星日。

严格来说由于岁差现象，春分点方向并不相对于宇宙遥远物质固定，因此恒星日与地球自转周期略有差异。不过两者的差异也不过几毫秒而已，可以忽略不计。故而通常默认恒星日就是地球自转周期。

平太阳日与恒星日随着时间推移都有所变化，不过通常默认它们（在短时间内）不变，因为变化程度很小。

### 平太阳日与恒星日的关系
不知诸位是否听说过「硬币悖论」——如果没有听过的话可以自行搜寻了解。1982 年 5 月 1 日的 SAT（全名就叫 SAT，不过有个俗称「美国高考」）就有一题不慎陷入了这个坑，毕竟出题人就没想那么多。

平太阳日与恒星日的差异恰恰就是硬币悖论造成的。

首先要提及的是，恒星日是将春分点方向当作固定方向得到的，故下面分析地球公转时同样用春分点视角。于是地球公转周期要当作回归年而非恒星年（宇宙遥远物质视角的周期，即实际周期）。

假设回归年是 $T$ 平太阳日。地球公转一周后，从平太阳的视角来看，共自转了 $T$ 周。由于硬币悖论，从春分点方向的视角来看，还会多自转一周而成为 $T+1$ 周。这样回归年便为 $T+1$ 恒星日。

用 $\text{d}\_\text{solar}$ 和 $\text{d}\_\text{sidereal}$ 分别表示平太阳日和恒星日，由上有 $T\kern{3 mu}\text{d}\_\text{solar}=(T+1)\kern{3 mu}\text{d}\_\text{sidereal}$。

平太阳日与恒星日之比便是 $\dfrac{\text{d}\_\text{solar}}{\text{d}\_\text{sidereal}}=\dfrac{T+1}{T}=1+\dfrac{1}{T}$。

回归年约为 365.2422 平太阳日，于是 $T\doteq365.2422$。计算得平太阳日与恒星日之比约为 1.002737909，该数值见于 IERS 约定。

### 用时间量纲计量角度
如果要用这类天文现象计量时间流逝的话就免不了测量角度。

上节讲到了「天」的原始含义。要贴近历史上的这个定义，时间 $1\kern{3 mu}\text{d}$ 就要对应角度 $360^\circ$。

由此，时角比（这个是我现编的伪术语，就当作是简便称呼）也就成为 $\dfrac{1\kern{3 mu}\text{d}}{360^\circ}=\dfrac{1}{15}\kern{3 mu}^\text{s}\kern{-3 mu}/\kern{-3 mu}\_\text{as}$。这个比例系数在后文相当常用。

### 太阳时与恒星时
先简要引入时角这一概念。从地方经线沿西往天体所在经线所计的夹角称作天体在地方的时角。

……但，为何以西为正呢？其实，从地方经线沿西往天体所在经线计夹角，同时就是从天体所在经线沿东往地方经线计夹角。把天体方向当作固定方向的话，由于地球自西向东公转，时角就会随时刻向后推移而越来越大了。

只是人毕竟是在地球某地观测天文现象的，所以用起点在观测点的说法就是以西为正。

太阳的时角乘上时角比就是天文太阳时，春分点的时角乘上时角比就是恒星时。太阳时也有视太阳时和平太阳时之分。

这样，天文太阳时的时刻零点是太阳正午，一个太阳日是 24 小时的太阳时，一个恒星日就是 24 小时的恒星时。

但是民用习惯的时刻零点是午夜，所以给天文太阳时加上 12 小时就得到了民用太阳时。

$t_\text{civil solar}=t_\text{astronomical solar}+12\kern{3 mu}\text{h}$

现在规范意义的术语「太阳时」是民用太阳时，但也确实存在用「太阳时」指代天文太阳时的情况，翻阅资料时务必留心。

设按平太阳时和恒星时所计的时间各为 $\Delta t_\text{solar}=k_\text{solar}\Delta t$ 和 $\Delta t_\text{sidereal}=k_\text{sidereal}\Delta t$。

$24\kern{3 mu}\text{h}=k_\text{solar}\kern{3 mu}\text{d}\_\text{solar}=k_\text{sidereal}\kern{3 mu}\text{d}\_\text{sidereal}$

因此 $\dfrac{\Delta t_\text{sidereal}}{\Delta t_\text{solar}}=\dfrac{k_\text{sidereal}}{k_\text{solar}}=\dfrac{\text{d}\_\text{solar}}{\text{d}\_\text{sidereal}}\doteq1.002737909$。

按恒星时与平太阳时计——而非反过来——的时间之比约为 1.002737909，也就是用恒星时的话会显得大一点。毕竟恒星日比平太阳日要短，与更短的时间比就会显得更长。

这个关系比较重要。因为平太阳终究不是现实的太阳，要得到平太阳时还是得从恒星时换算。

### GMT 的混乱历史
相信诸位或多或少会在时间相关的环境看到「GMT」这个词，它的全称是「Greenwich Mean Time」。

Greenwich 平均时间（英 Greenwich Mean Time, GMT）到底是什么呢？我也不知道——别笑，因为我确实不知道。

GMT 本身就是含义十分模糊的词语。从字面上看，GMT 是 Greenwich 经线的平均时，确切而言是平太阳时。但是现在所讲的 GMT 不能这样简单理解。

这个词语的含义为何会含混不清呢？自然是因为它有着混乱的历史。

说来也怪，GMT 的含义不但与历史时点有关，而且同时点不同机构也可能有所不同。

- 1805 年为止的英国皇家海军：使用 Greenwich 经线的时间，日期从正午算起，当天时刻从午夜算起。

19 世纪初尚且没有标准时的概念。各地使用当地的平太阳时，跨城市时就要重新校准时钟。在英国，由于蒸汽机车的发明与改进，铁路运输系统也就慢慢建立起来了。但这就出现了问题——短时间跨越长距离的话，校准时钟的频率可就相当高了，可能导致混乱，甚至发生事故。

1840 年 11 月，大西部铁路率先在时间表统一使用 GMT，「铁路时间」这一概念出现了。其它铁路局纷纷效仿。

- 民用意义下的 GMT：Greenwich 经线的平太阳时，日期和当天时刻均从午夜算起。

1847 年 9 月 22 日，铁路清算所下令，一旦邮政总局允许，所有车站均应采用 GMT。

1880 年 8 月 2 日，《时间定义法案》通过，GMT 获得法律地位而逐渐推广到全英国。

1884 年 10 月的国际经线会议上，Greenwich 经线成为 0° 经线，GMT 也就成为了通用时间。顺带一提，会议表决的世界日是从午夜算起的，符合民用习惯，也就是说起点比天文习惯的天文日早 12 小时。

……不过法国弃权了，而且相当长一段时间还坚持以 Paris 经线作为 0° 经线，甚至不肯叫 Greenwich 这个名字。

- 1925 年以前天文学意义下的 GMT：Greenwich 经线的平太阳时，日期和当天时刻均从正午算起。

- 1925 年以前英国天文年历的 GMT：Greenwich 经线的平太阳时，日期和当天时刻均从正午算起。

- 1925 年以来英国天文年历的 GMT：Greenwich 经线的平太阳时，日期和当天时刻均从午夜算起。

也就是说 00:00:00 从正午（现代意义的 12:00:00）突变为午夜（现代意义的 00:00:00）。天文意义就分出了「旧 GMT」和「新 GMT」。

1928 年 IAU 规定，将日期和当天时刻均从正午算起的 GMT 称为 Greenwich 平均天文时间（英 Greenwich Mean Astronomical Time, GMAT）。但是，人们似乎无视了这回事，于是 GMAT 也可能继续记为 GMT。乐死了.png

如此混乱的历史表明 GMT 这个词不能再用了，应该用新词来描述日期和当天时刻均从午夜算起的 GMT。

### UT
1884 年 10 月的国际经线会议中除了引入了「世界日」，还引入了「世界时」，但并没有作为专有名词。这个「世界时」仅仅只是避免在指称时出现地名而已。

1928 年 IAU 规定，将日期和当天时刻均从午夜算起的 GMT 称为世界时（英 Universal Time, UT、法 Temps universel, \[旧\] TU）；UT 又可称为 Greenwich 民用时间（英 Greenwich Civil Time, GCT）——但夏令时一实施的话，就会出现「Greenwich 民众使用的时间不是 GCT」的奇怪场景，所以这一条到 1935 年又废止了。德语可将 UT 称为 Weltzeit，缩写为 WZ。

1948 年 IAU 又重申了 UT 和 WZ 的用法。

1976 年 [IAU 第 16 届大会](https://www.iau.org/static/resolutions/IAU1976_French.pdf)上，第 4 和 31 委员会的第 1 号决议主张应将 GMT 按具体情形替换为 UT0、UT1、UT2 或 UTC，差异不重要时使用 UT；第 3 号决议主张缩写 TAI、TA、UT0、UT1、UT2、UTC、UT 用于任何语文，因此法文缩写 TU 不再使用。

至此，原始的民用 GMT 已经被 UT 这个词代替了，不应再使用。

### UT0
要测定世界时应该怎么做呢？时角（不考虑定向的话）是两条经线的夹角，因此计算世界时就要考虑经度。

世界时是 0° 经线的平太阳时。但是平太阳并不存在，所以只好直接测定恒星时角。

设世界时为 $\text{UT0}$，0° 经线恒星时为 $T_G$，地方恒星时为 $T_l$，观测站的经度为 $\lambda$，春分点的经度为 $\lambda_\text{VE}$，时角比为 $k$。此外，已知世界时为 $t_0$ 时 0° 经线恒星时为 $T_0$。

由于经度以东为正，从经度为 $A$ 的经线沿西往经度为 $B$ 的经线所计的夹角就是 $-(B-A)=A-B$。

$T_G=k(0-\lambda_\text{VE})$

$T_l=k(\lambda-\lambda_\text{VE})$

$\text{UT0}=t_0+\dfrac{\Delta t_\text{solar}}{\Delta t_\text{sidereal}}(T_G-T_0)$

联立解得 $\text{UT0}=t_0+\dfrac{\Delta t_\text{solar}}{\Delta t_\text{sidereal}}(T_l-k\lambda-T_0)$。

### UT1
考虑到极移现象，地球的自转轴并不相对于地球静止，所以地方经纬度也在不断变化。

计算 UT0 时用的经度是平均经度（可以认为是 ITRS 下的经度），没有考虑极移。如果要考虑极移，就得将南北方向置于真正的自转轴上，重新折算瞬时经度才行。

那就把 $z$ 轴建在自转轴上。回想起来，TIRS 便是如此。

$\text{\[TIRS\]}=W(t)\text{\[ITRS\]}=R_3(-s')R_2(x_p)R_1(y_p)\text{\[ITRS\]}$

当然，TIO 定位角并不需要考虑。一方面它本身非常小；另一方面我们的目的是把时刻统一起来，而它对经度差没有影响——大家都差那么多就相当于都没差。

因此考虑 $R_2(x_p)R_1(y_p)$ 就足够了。不妨用下标 $i$ 表示瞬时经纬度，无下标表示平均经纬度。寻找 $(\varphi_i,\lambda_i)$ 与 $(\varphi,\lambda)$ 的关系即可。

$\begin{aligned}\left\[\begin{matrix}\cos\varphi_i\cos\lambda_i\cr\cos\varphi_i\sin\lambda_i\cr\sin\varphi_i\end{matrix}\right\]&=R_2(x_p)R_1(y_p)\left\[\begin{matrix}\cos\varphi\cos\lambda\cr\cos\varphi\sin\lambda\cr\sin\varphi\end{matrix}\right\]\cr&=\left\[\begin{matrix}\cos x_p & 0 & -\sin x_p\cr0 & 1 & 0\cr\sin x_p & 0 & \cos x_p\end{matrix}\right\]\left\[\begin{matrix}1 & 0 & 0\cr0 & \cos y_p & \sin y_p\cr0 & -\sin y_p & \cos y_p\end{matrix}\right\]\left\[\begin{matrix}\cos\varphi\cos\lambda\cr\cos\varphi\sin\lambda\cr\sin\varphi\end{matrix}\right\]\cr&=\left\[\begin{matrix}\cos x_p\cos\varphi\cos\lambda+\sin x_p\sin y_p\cos\varphi\sin\lambda-\sin x_p\cos y_p\sin\varphi\cr\cos y_p\cos\varphi\sin\lambda+\sin y_p\sin\varphi\cr\sin x_p\cos\varphi\cos\lambda-\cos x_p\sin y_p\cos\varphi\sin\lambda+\cos x_p\cos y_p\sin\varphi\end{matrix}\right\]\end{aligned}$

……大抵不会有别的人像我这样蠢到手算了。

于是 $\lambda_i=\operatorname{atan2}(\cos y_p\cos\varphi\sin\lambda+\sin y_p\sin\varphi,\cos x_p\cos\varphi\cos\lambda+\sin x_p\sin y_p\cos\varphi\sin\lambda-\sin x_p\cos y_p\sin\varphi)$。

令 $\Delta\lambda=\lambda_i-\lambda$，则得到经度修正量。应该怎么用呢？

设测到的地方时为 $T$，实际上的世界时为 $\text{UT1}$。最初计算世界时的时候以为观测站的经度就是 $\lambda$，因此算出来的世界时 $\text{UT0}=t_0+\dfrac{\Delta t_\text{solar}}{\Delta t_\text{sidereal}}(T_l-k\lambda-T_0)$。

观测站的实际经度应该是 $\lambda_i=\lambda+\Delta\lambda$。

代入得 $\begin{aligned}\text{UT1}&=t_0+\dfrac{\Delta t_\text{solar}}{\Delta t_\text{sidereal}}(T_l-k\lambda_i-T_0)\cr&=t_0+\dfrac{\Delta t_\text{solar}}{\Delta t_\text{sidereal}}(T_l-k(\lambda+\Delta\lambda)-T_0)\cr&=t_0+\dfrac{\Delta t_\text{solar}}{\Delta t_\text{sidereal}}(T_l-k\lambda-T_0)-k\dfrac{\Delta t_\text{solar}}{\Delta t_\text{sidereal}}\Delta\lambda\cr&=\text{UT0}-k\dfrac{\Delta t_\text{solar}}{\Delta t_\text{sidereal}}\Delta\lambda\end{aligned}$。

$\text{UT1}=\text{UT0}-k\dfrac{\Delta t_\text{solar}}{\Delta t_\text{sidereal}}\Delta\lambda$

另外 $\Delta\lambda$ 的表达式过于复杂，也应该尽可能在保证精度的同时简化。

注意到 $\displaystyle\lim_{(x_p,y_p)\rightarrow(0,0)}\Delta\lambda=0$（至少在 $\lambda\ne\pi$ 时如此），于是 $(x_p,y_p)$ 充分接近 $(0,0)$ 时将有 $\Delta\lambda=\arctan\tan(\lambda_i-\lambda)$。

令 $(\alpha,\beta)=(\cos y_p\cos\varphi\sin\lambda+\sin y_p\sin\varphi,\cos x_p\cos\varphi\cos\lambda+\sin x_p\sin y_p\cos\varphi\sin\lambda-\sin x_p\cos y_p\sin\varphi)$，则 $\tan\lambda_i=\dfrac{\alpha}{\beta}$。

$\Delta\lambda=\arctan\tan(\lambda_i-\lambda)=\arctan\dfrac{\tan\lambda_i-\tan\lambda}{1+\tan\lambda_i\tan\lambda}=\arctan\dfrac{\alpha-\beta\tan\lambda}{\beta+\alpha\tan\lambda}$

将 $\alpha$ 与 $\beta$ 按 $x_p$ 与 $y_p$ 展开成 Taylor 多项式，阶数够用就行。

$\alpha=\cos\varphi\sin\lambda+y_p\sin\varphi+o\left(\sqrt{x_p^2+y_p^2}\right)$

$\beta=\cos\varphi\cos\lambda-x_p\sin\varphi+o\left(\sqrt{x_p^2+y_p^2}\right)$

「所以你就只展开到一阶？」

嘛人一懒就是这样的。

$\dfrac{\alpha-\beta\tan\lambda}{\beta+\alpha\tan\lambda}=\dfrac{(x_p\sin\lambda+y_p\cos\lambda)\tan\varphi+o\left(\sqrt{x_p^2+y_p^2}\right)}{1-(x_p\cos\lambda-y_p\sin\lambda)\tan\varphi+o\left(\sqrt{x_p^2+y_p^2}\right)}=(x_p\sin\lambda+y_p\cos\lambda)\tan\varphi+o\left(\sqrt{x_p^2+y_p^2}\right)$

……这一部分仍然是手算的，应该没有算错。

$\Delta\lambda=\arctan\dfrac{\alpha-\beta\tan\lambda}{\beta+\alpha\tan\lambda}=(x_p\sin\lambda+y_p\cos\lambda)\tan\varphi+o\left(\sqrt{x_p^2+y_p^2}\right)$

这样 $(x_p\sin\lambda+y_p\cos\lambda)\tan\varphi$ 便成为 $\Delta\lambda$ 关于变元 $(x_p,y_p)$ 在 $(0,0)$ 附近的一阶近似，于是可以直接把它当作 $\Delta\lambda$。

$\Delta\lambda=(x_p\sin\lambda+y_p\cos\lambda)\tan\varphi$

$\text{UT1}=\text{UT0}-\dfrac{1}{15\times1.002737909}\kern{3 mu}^\text{s}\kern{-3 mu}/\kern{-3 mu}\_\text{as}\kern{3 mu}(x_p\sin\lambda+y_p\cos\lambda)\tan\varphi$

最终得到了 UT0 的极移修正版本，也就是 UT1。通常所说的 UT 便是指 UT1。

不过 $\|\Delta\lambda\|$ 本身很小，所以实际计算时通常就取 $\dfrac{\Delta t_\text{solar}}{\Delta t_\text{sidereal}}=1$，公式也就近似为 $\text{UT1}=\text{UT0}-\dfrac{1}{15}\kern{3 mu}^\text{s}\kern{-3 mu}/\kern{-3 mu}\_\text{as}\kern{3 mu}(x_p\sin\lambda+y_p\cos\lambda)\tan\varphi$。当然，本文这一步就不近似了。

值得注意的是，[Bulletin horaire 1955](https://www.ucolick.org/~sla/leapsecs/BHs4n4.pdf) 给出的公式和上面写的并不一样。

$\Delta\lambda=\lambda_i-\lambda_m=\dfrac{1}{15}(x\sin\lambda_m-y\cos\lambda_m)\tan\varphi_m$

$\text{TU1}=\text{TU0}+\Delta\lambda$

因为当时国际时间局（法 Bureau international de l'heure, BIH、英 International Time Bureau）的约定是西经为正，所以当中出现的 $\lambda$ 其实相当于现在的 $-\lambda$。这个 $\Delta\lambda$（忽略量纲差异的话）也就成了之前所述 $\Delta\lambda$ 的相反数。

将 $\lambda$ 全部换成 $-\lambda$ 试试。

$\Delta(-\lambda)=-\lambda_i-(-\lambda_m)=\dfrac{1}{15}(x\sin(-\lambda_m)-y\cos(-\lambda_m))\tan\varphi_m$

$\text{TU1}=\text{TU0}+\Delta(-\lambda)$

然后化简。

$\Delta\lambda=\lambda_i-\lambda_m=\dfrac{1}{15}(x\sin\lambda_m+y\cos\lambda_m)\tan\varphi_m$

$\text{TU1}=\text{TU0}-\Delta\lambda$

忽略量纲差异的话，可以看出并没有区别。

然而这个 UT1 的算法已经过时了，现在已经不再通过天文观测确定时间，UT0 也就不再使用。现代计算 UT1 借助 ERA（就是之前提到过的地球自转角）完成。

考虑到当今 UT1 才是可以直接得到的参数，书写公式时通常写成 UT0 减去 UT1 的形式。

$\text{UT0}-\text{UT1}=\dfrac{1}{15\times1.002737909}\kern{3 mu}^\text{s}\kern{-3 mu}/\kern{-3 mu}\_\text{as}\kern{3 mu}(x_p\sin\lambda+y_p\cos\lambda)\tan\varphi$（其中 CIP 坐标 $x_p$ 与 $y_p$ 之正向依照 IERS 约定，分别指向 0° 与 90°W 经线）

### UT2
地球自转的状况其实也和季节有关。

姑且说一种比较扯而又不是没可能的原因。冬天积雪、夏天融雪会使地球的转动惯量改变，从而影响自转。当然，听起来有点「同性恋清淡饮食可以成为异性恋」的味道，不过并不是那么不靠谱。大气压、地下水应该也算可能的原因。

UT2 便是在 UT1 的基础上用经验公式加偏移来处理这个问题。公式的系数倒是变过几次。

先放一下 [Bulletin horaire 1955](https://www.ucolick.org/~sla/leapsecs/BHs4n4.pdf) 中规定的 1956 年用公式。

$\Delta T_s=+0^\text{s},022\sin2\pi t-0^\text{s},017\cos2\pi t-0^\text{s},007\sin4\pi t+0^\text{s},006\cos4\pi t$

下标大抵是指 saisonnière（季节的）。倒也没讲清楚 $t$ 指什么。

UT0、UT1 与 UT2 三者间的关系用连等式 $\text{TU2}=\text{TU0}+\Delta\lambda+\Delta T_s=\text{TU1}+\Delta T_s$ 表示。

最终确定的公式是下面这个。

$\text{UT2}-\text{UT1}=(0.022\sin2\pi T-0.012\cos2\pi T-0.006\sin4\pi T+0.007\cos4\pi T)\kern{3 mu}\text{s}$

而且明确指出了 $T$ 为 Bessel 年。

IERS 公告的补充说明曾（[1992 年 12 月](https://web.archive.org/web/19980426111938/http://gibs.leipzig.ifag.de/MISC/IERS/bulletinb.guide.old)、[1994 年 3 月](https://web.archive.org/web/19980426111938/http://gibs.leipzig.ifag.de/MISC/IERS/bulletinb.guide.old)、[1995 年 3 月](https://web.archive.org/web/19980426095006/http://gibs.leipzig.ifag.de/MISC/IERS/bulletinb.guide)、[2000 年 3 月](https://hpiers.obspm.fr/iers/bul/bulb/BULLETINB.html)）指定的 Bessel 年算法为 $T=2000.000+\dfrac{\text{MJD}-51544.03}{365.2422}$。

到 [2004 年 8 月](https://hpiers.obspm.fr/iers/bul/bulb/explanatory.pdf)又删了。可能是觉得之前给的算法系数精度有些低，或者是发现计算机的算力在迅速发展。这么一想原点偏移到 2000 年大抵是为了减小 2000 年前后的误差。不过……[美国海军天文台某网页](https://maia.usno.navy.mil/information/eo-values)还留着呢。

MJD 用哪个时间尺度算才对呢？其实给出这个公式的时候好像没太有区分 JD 的时间尺度的概念，至少[《2001 年用天文年历》](https://archive.org/details/astronomicalalma0000unse_i5l9)（见 B4 页）中确实没有。

$\text{Julian epoch}=\text{J}\left\[2000.0+\dfrac{\text{JD}-2451545.0}{365.25}\right\]$

$\text{Besselian epoch}=\text{B}\left\[1900.0+\dfrac{\text{JD}-2415020.31352}{365.242198781}\right\]$

到现在便重视时间尺度的差异了，[《2017 年用天文年历》](https://archive.org/details/astronomicalalma0000unse_s2r1)（见 B3 页）就用下标明确指出按地球时算。

$\text{Julian epoch}=\text{J}\left\[2000.0+\dfrac{\text{JD}\_\text{TT}-2451545.0}{365.25}\right\]$

$\text{Besselian epoch}=\text{B}\left\[1900.0+\dfrac{\text{JD}\_\text{TT}-2415020.31352}{365.242198781}\right\]$

规定用地球时也不是没有原因。因为过去计算纪元时用的是历书时，而地球时设计上正是为了取代历书时。

$\text{UT2}-\text{UT1}=(0.022\sin2\pi T-0.012\cos2\pi T-0.006\sin4\pi T+0.007\cos4\pi T)\kern{3 mu}\text{s}$（其中 $T=1900.0+\dfrac{\text{JD}\_\text{TT}-2415020.31352}{365.242198781}$）

现在很少使用 UT2 了，不过 IERS 公告 A 至今还在开头提供 UT2 的公式。

## 原子时
### 原子钟与秒的现代定义
高中物理中讲到，核外电子跃迁有光子的频率条件，而且这个频率条件相当稳定。如果以跃迁状态作为反馈讯号调节计时器，使计时器的频率与跃迁频率保持一致，计时器就能准确走时而不乱跑了。这就是原子钟的原理。

~~我没用过原子钟，更没制造过原子钟，以上说法是我凭空脑补的。~~

原子核自旋、电子自旋等对称破缺因素会导致能级分裂。特别是，碱金属原子可以分裂出间隔很小的超精细能级，跃迁频率在微波级别。毕竟频率堪比可见光的震荡源还不是太成熟的东西，不过光钟也在试验就是了。

现在的物理界中，单位的物理含义总与 SI 定义挂钩。哪怕用 Gauss 单位制这样的非 SI 单位制也好，仍要转换成 SI 然后依 SI 定义解释物理含义。时间单位的解释也不例外。

既然提到了 SI，就不得不提定义并贯彻实施 SI 的国际计量组织。依《米制公约》，国际计量组织共设立三个机构。
- 国际计量局（法 Bureau international des poids et mesures, BIPM、英 International Bureau of Weights and Measures）
- 国际计量委员会（法 Comité international des poids et mesures, CIPM、英 International Committee for Weights and Measures）
- 国际计量大会（法 Conférence générale des poids et mesures, CGPM、英 General Conference on Weights and Measures）

三者的职责分配则依《米制公约》第三条所定——BIPM 在 CIPM 的指导和监督下运作，而 CIPM 本身则受由各缔约国政府代表所组成的 CGPM 管辖。

1967 年 10 月，CGPM 第 13 次大会第 1 号决议修改了 SI 中秒的定义。自此，SI 中秒便是以铯-133 原子不受扰动的基态超精细能级跃迁频率 $\Delta\nu_\text{Cs}$ 定义的，也就是秒的现代定义。

$1\kern{3 mu}\text{s}=\dfrac{9192631770}{\Delta\nu_\text{Cs}}$

### 国际原子时
1948 年，美国国家标准局研制出世界上第一台氨原子钟……等等，氨？它确实没用当今常见的铯原子，而是用了氨分子。然而这玩意走时比石英钟还不准，拿来计时就相当不可靠了。

1955 年，英国国家物理实验室研制出世界上第一台铯原子钟。铯原子钟就相当可靠，可谓好铯。虽然当时仅仅是偶尔找机会用单个原子钟校准石英钟，而不是让原子钟持续跑下去。由此得到了 Greenwich 原子时（英 Greenwich Atomic, GA）。

1956 年 9 月 13 日，美国海军天文台根据美国海军研究实验室的铯原子钟得到了原子时标准，称作 A.1。1959 年，A.1 的历元被重置到 UT2 的 1958 年 1 月 1 日 00:00:00。当然当时各个机关用的 UT2 都不见得相同，至少这里是指美国海军天文台自身维护的 UT2。

1957 年 10 月 9 日，美国国家标准局也有了自己的原子时标准 NBS-A，而且历元也在 1959 年重置到了 UT2 的 1958 年 1 月 1 日 00:00:00。

有着如此多各有差异的原子时标准，要比较记录就显得相当麻烦。各原子时标准的历元从 1959 年开始重置，一直到 1960 年才全部重置完毕。

SI 秒启用原子跃迁频率定义之前是以历书时定义的，称为历书秒。

1958 年，英国国家物理实验室与美国海军天文台的联合实验[结果](http://www.leapsecond.com/history/1958-PhysRev-v1-n3-Markowitz-Hall-Essen-Parry.pdf)表明，一个历书秒相当于铯-133 原子不受扰动的基态超精细能级跃迁的 9192631770 个周期。这就为 SI 秒的新定义打下了实验基础。

1967 年 8 月 [IAU 第 13 届大会](https://www.iau.org/static/resolutions/IAU1967_French.pdf)上，第 4 和 31 委员会的第 5 号决议指出，如果历书秒不再是 SI 的一部分，CGPM 就应当在决议文本中注明历书秒为 IAU 天文常数——这是 IAU 的要求。

结果 1967 年 10 月 CGPM 第 13 次大会上并没有同意这个要求。BIPM 负责人 J. Terrien 后来指出 BIPM 并不做时间和频率测量的实验工作，并且认为这方面天文学家和物理学家之间有着误解。

国际原子时（法 Temps atomique international, TAI、英 International Atomic Time）

## 协调世界时

## 地球时
$\text{TT}=\text{TAI}+32.184\kern{3 mu}\text{s}$
